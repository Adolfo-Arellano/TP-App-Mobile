<ion-content>
  <div class="profile-container">
    <!-- Cabecera del perfil -->
    <div class="profile-header">
      <div class="profile-avatar" (click)="changeProfilePicture()">
        <ion-avatar>
          <ion-img [src]="profileImage" alt="Profile Picture"></ion-img>
        </ion-avatar>
        <div class="change-photo-overlay">
          <ion-icon name="camera"></ion-icon>
        </div>
      </div>
      <div class="user-info">
        <ion-text class="user-email">
          <ion-label>{{ user?.email || 'Usuario' }}</ion-label>
        </ion-text>
        <ion-text class="user-since" *ngIf="user?.metadata?.creationTime">
          <ion-label>Miembro desde {{ user?.metadata?.creationTime | date:'MMM yyyy' }}</ion-label>
        </ion-text>
      </div>
    </div>

    <!-- Secciones del perfil -->
    <div class="profile-sections">
      <!-- Información Personal -->
      <ion-item-group>
        <ion-item-divider>
          <ion-label>Información Personal</ion-label>
        </ion-item-divider>

        <ion-item button detail (click)="editProfile()">
          <ion-icon name="person-outline" slot="start"></ion-icon>
          <ion-label class="ion-label-info">
            <div class="label-title">Perfil</div>
            <div class="label-subtitle">{{ user?.displayName || 'Editar información personal' }}</div>
          </ion-label>
        </ion-item>
        
        <ion-item button detail (click)="editEmail()">
          <ion-icon name="mail-outline" slot="start"></ion-icon>
          <ion-label class="ion-label-info">
            <div class="label-title">Email</div>
            <div class="label-subtitle">{{ user?.email }}</div>
          </ion-label>
        </ion-item>
      </ion-item-group>

      <!-- Seguridad -->
      <ion-item-group>
        <ion-item-divider>
          <ion-label>Seguridad</ion-label>
        </ion-item-divider>

        <ion-item button detail (click)="changePassword()">
          <ion-icon name="lock-closed-outline" slot="start"></ion-icon>
          <ion-label>
            <h3>Contraseña</h3>
            <p>Cambiar contraseña</p>
          </ion-label>
        </ion-item>

        <ion-item button [detail]="!user?.emailVerified" (click)="!user?.emailVerified && verifyEmail()">
          <ion-icon name="shield-checkmark-outline" slot="start"></ion-icon>
          <ion-label>
            <h3>Verificación</h3>
            <p>Estado de la cuenta</p>
          </ion-label>
          <ion-badge slot="end" [color]="user?.emailVerified ? 'success' : 'warning'">
            {{ user?.emailVerified ? 'Verificado' : 'Pendiente' }}
          </ion-badge>
        </ion-item>
      </ion-item-group>

      <!-- Redes Sociales -->
      <ion-item-group>
        <ion-item-divider>
          <ion-label>Redes Sociales</ion-label>
        </ion-item-divider>

        <ion-item (click)="handleTwitterConnection()" button>
          <ion-icon name="logo-twitter" slot="start"></ion-icon>
          <ion-label>
            <h3>Twitter</h3>
            <p>{{ isTwitterLinked ? 'Conectado' : 'Conectar cuenta' }}</p>
          </ion-label>
          <ion-badge slot="end" [color]="isTwitterLinked ? 'success' : 'medium'">
            {{ isTwitterLinked ? 'Conectado' : 'Desconectado' }}
          </ion-badge>
        </ion-item>
      </ion-item-group>
    </div>

    <!-- Botón de cerrar sesión -->
    <ion-button expand="block" class="logout-button" (click)="logout()">
      <ion-icon name="log-out-outline" slot="start"></ion-icon>
      Cerrar Sesión
    </ion-button>
  </div>
</ion-content>
