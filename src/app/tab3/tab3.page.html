<ion-header>
  <ion-toolbar color="dark">
    <ion-title>Conversor</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content class="ion-padding" color="dark">
  <ion-list>
    <!-- Selector De: -->
    <ion-item color="dark">
      <ion-label>De:</ion-label>
      <ion-button *ngIf="!fromType" 
                  expand="block"
                  (click)="seleccionarTipo('monedas', 'from')"
                  color="warning">
        Monedas
      </ion-button>
      <ion-button *ngIf="!fromType"
                  expand="block"
                  (click)="seleccionarTipo('cryptos', 'from')"
                  color="warning">
        Criptomonedas
      </ion-button>
      <div *ngIf="fromCurrency" class="selected-currency">
        <span>{{fromCurrency.name}} ({{fromCurrency.code || fromCurrency.id}})</span>
        <ion-button fill="clear" 
                    (click)="limpiarSeleccion('from')"
                    color="danger">
          <ion-icon name="close-circle"></ion-icon>
        </ion-button>
      </div>
    </ion-item>

    <!-- Búsqueda y lista "De:" -->
    <div *ngIf="showFromSearch" class="search-container">
      <ion-searchbar (ionInput)="buscar($event)"
                     placeholder="Buscar moneda..."
                     color="dark">
      </ion-searchbar>
      <ion-list class="currency-list">
        <ion-item *ngFor="let currency of filteredCurrencies" 
                  (click)="seleccionarMoneda(currency)"
                  color="dark"
                  button>
          {{currency.name}} ({{currency.code || currency.id}})
        </ion-item>
      </ion-list>
    </div>

    <!-- Selector A: -->
    <ion-item color="dark">
      <ion-label>A:</ion-label>
      <ion-button *ngIf="!toType"
                  expand="block"
                  (click)="seleccionarTipo('monedas', 'to')"
                  color="warning">
        Monedas
      </ion-button>
      <ion-button *ngIf="!toType"
                  expand="block"
                  (click)="seleccionarTipo('cryptos', 'to')"
                  color="warning">
        Criptomonedas
      </ion-button>
      <div *ngIf="toCurrency" class="selected-currency">
        <span>{{toCurrency.name}} ({{toCurrency.code || toCurrency.id}})</span>
        <ion-button fill="clear"
                    (click)="limpiarSeleccion('to')"
                    color="danger">
          <ion-icon name="close-circle"></ion-icon>
        </ion-button>
      </div>
    </ion-item>

    <!-- Búsqueda y lista "A:" -->
    <div *ngIf="showToSearch" class="search-container">
      <ion-searchbar (ionInput)="buscar($event)"
                     placeholder="Buscar moneda..."
                     color="dark">
      </ion-searchbar>
      <ion-list class="currency-list">
        <ion-item *ngFor="let currency of filteredCurrencies"
                  (click)="seleccionarMoneda(currency)"
                  color="dark"
                  button>
          {{currency.name}} ({{currency.code || currency.id}})
        </ion-item>
      </ion-list>
    </div>
  </ion-list>

  <!-- Resultado de la conversión modificado -->
  <ion-card *ngIf="conversionResult && fromCurrency && toCurrency" color="dark" class="conversion-result">
    <ion-card-content>
      <div class="conversion-text">
        {{amount}} {{fromCurrency.code || fromCurrency.id}} = {{conversionResult | number:'1.0-8'}} {{toCurrency.code || toCurrency.id}}
      </div>
    </ion-card-content>
  </ion-card>

  <!-- Calculadora -->
  <div class="calculator-container">
    <ion-input readonly [value]="amount" class="calculator-display"></ion-input>
    
    <div class="calculator-grid">
      <ion-button *ngFor="let button of calculatorButtons" 
                  (click)="handleCalculatorInput(button.value)"
                  color="warning">
        {{button.display}}
      </ion-button>
    </div>
  </div>
</ion-content>